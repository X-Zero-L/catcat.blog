---
import Analytics from '@vercel/analytics/astro';
---

<Analytics />

<script>
// 防止 Vercel Analytics 重复注册
if (typeof window !== 'undefined') {
  // 标记 Analytics 已加载
  if (!window.__vercelAnalyticsLoaded) {
    window.__vercelAnalyticsLoaded = true;
  }
  
  // 在 Swup 页面切换时阻止重复加载
  if (window.swup) {
    window.swup.hooks.on('content:replace', () => {
      // Analytics 组件会自动处理页面切换
    });
  }
}
</script>